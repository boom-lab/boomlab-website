<!DOCTYPE html>
<html lang="en" data-dark="false">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!--
  put your analytics (e.g. Google Analytics) tracking code here
-->

  <!--
  put your search engine verification (e.g. Google Search Console) tag here
-->

  


























<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Poseidon basics | nicholson boom-lab</title>

<link rel="icon" href="/images/icon.png">

<meta name="title" content="Poseidon basics">
<meta name="description" content="Woods Hole Oceanographic Institution. The Biogeochemical Ocean Observing and Modeling Lab at the Woods Hole Oeanographic Institution">

<meta property="og:title" content="Poseidon basics">
<meta property="og:site_title" content="nicholson boom-lab">
<meta property="og:description" content="Woods Hole Oceanographic Institution. The Biogeochemical Ocean Observing and Modeling Lab at the Woods Hole Oeanographic Institution">
<meta property="og:url" content="">
<meta property="og:image" content="/images/share.jpg">
<meta property="og:locale" content="en_US">

<meta property="twitter:title" content="Poseidon basics">
<meta property="twitter:description" content="Woods Hole Oceanographic Institution. The Biogeochemical Ocean Observing and Modeling Lab at the Woods Hole Oeanographic Institution">
<meta property="twitter:url" content="">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:image" content="/images/share.jpg">


  <meta name="author" content="colette-kelly">
  <meta property="og:type" content="article">
  <meta property="og:updated_time" content="2024-01-02T19:15:43+00:00">
  <meta property="article:published_time" content="2023-10-03T00:00:00+00:00">
  <meta property="article:modified_time" content="2024-01-02T19:15:43+00:00">
  <meta name="revised" content="2024-01-02T19:15:43+00:00">


<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "BlogPosting",
      "author": { "@type": "Person", "name": "Poseidon basics" },
      "datePublished": "2023-10-03T00:00:00+00:00",
      "dateModified": "2024-01-02T19:15:43+00:00",
    
    "name": "Poseidon basics",
    "description": "Woods Hole Oceanographic Institution. The Biogeochemical Ocean Observing and Modeling Lab at the Woods Hole Oeanographic Institution",
    "headline": "Poseidon basics",
    "publisher": {
      "@type": "Organization",
      "logo": { "@type": "ImageObject", "url": "/images/icon.png" }
    },
    "url": ""
  }
</script>

<link rel="alternate" type="application/rss+xml" href="/feed.xml">

  <!-- Google Fonts -->
<!-- automatically get url from fonts used in theme file -->

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?display=swap&&family=Barlow:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600&amp;family=Roboto+Mono:ital,wght@0,200;0,400;0,500;0,600;1,200;1,400;1,500;1,600" rel="stylesheet">

<!-- Font Awesome icons (load asynchronously due to size) -->

<link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="preload" as="style" onload="this.onload = null; this.rel = 'stylesheet';">
<noscript>
  <link href="https://use.fontawesome.com/releases/v6.3.0/css/all.css" rel="stylesheet">
</noscript>

  <!-- third party styles -->
<!-- https://stylishthemes.github.io/Syntax-Themes/pygments/ -->
<link href="https://cdn.jsdelivr.net/gh/StylishThemes/Syntax-Themes/pygments/css-github/pygments-tomorrow-night-eighties.css" rel="stylesheet">

<!-- include all sass in styles folder -->


  
    <link href="/_styles/-theme.css" rel="stylesheet">
  

  
    <link href="/_styles/alert.css" rel="stylesheet">
  

  
    <link href="/_styles/all.css" rel="stylesheet">
  

  
    <link href="/_styles/anchor.css" rel="stylesheet">
  

  
    <link href="/_styles/background.css" rel="stylesheet">
  

  
    <link href="/_styles/body.css" rel="stylesheet">
  

  
    <link href="/_styles/bold.css" rel="stylesheet">
  

  
    <link href="/_styles/button.css" rel="stylesheet">
  

  
    <link href="/_styles/card.css" rel="stylesheet">
  

  
    <link href="/_styles/checkbox.css" rel="stylesheet">
  

  
    <link href="/_styles/citation.css" rel="stylesheet">
  

  
    <link href="/_styles/code.css" rel="stylesheet">
  

  
    <link href="/_styles/cols.css" rel="stylesheet">
  

  
    <link href="/_styles/dark-toggle.css" rel="stylesheet">
  

  
    <link href="/_styles/feature.css" rel="stylesheet">
  

  
    <link href="/_styles/figure.css" rel="stylesheet">
  

  
    <link href="/_styles/float.css" rel="stylesheet">
  

  
    <link href="/_styles/font.css" rel="stylesheet">
  

  
    <link href="/_styles/footer.css" rel="stylesheet">
  

  
    <link href="/_styles/form.css" rel="stylesheet">
  

  
    <link href="/_styles/grid.css" rel="stylesheet">
  

  
    <link href="/_styles/header.css" rel="stylesheet">
  

  
    <link href="/_styles/heading.css" rel="stylesheet">
  

  
    <link href="/_styles/highlight.css" rel="stylesheet">
  

  
    <link href="/_styles/icon.css" rel="stylesheet">
  

  
    <link href="/_styles/image.css" rel="stylesheet">
  

  
    <link href="/_styles/link.css" rel="stylesheet">
  

  
    <link href="/_styles/list.css" rel="stylesheet">
  

  
    <link href="/_styles/main.css" rel="stylesheet">
  

  
    <link href="/_styles/paragraph.css" rel="stylesheet">
  

  
    <link href="/_styles/portrait.css" rel="stylesheet">
  

  
    <link href="/_styles/post-excerpt.css" rel="stylesheet">
  

  
    <link href="/_styles/post-info.css" rel="stylesheet">
  

  
    <link href="/_styles/post-nav.css" rel="stylesheet">
  

  
    <link href="/_styles/quote.css" rel="stylesheet">
  

  
    <link href="/_styles/rule.css" rel="stylesheet">
  

  
    <link href="/_styles/search-box.css" rel="stylesheet">
  

  
    <link href="/_styles/search-info.css" rel="stylesheet">
  

  
    <link href="/_styles/section.css" rel="stylesheet">
  

  
    <link href="/_styles/table.css" rel="stylesheet">
  

  
    <link href="/_styles/tags.css" rel="stylesheet">
  

  
    <link href="/_styles/textbox.css" rel="stylesheet">
  

  
    <link href="/_styles/tooltip.css" rel="stylesheet">
  

  
    <link href="/_styles/util.css" rel="stylesheet">
  


<!-- include all css in styles folder -->



  <!-- third party scripts -->
<script src="https://unpkg.com/@popperjs/core@2" defer></script>
<script src="https://unpkg.com/tippy.js@6" defer></script>
<script src="https://unpkg.com/mark.js@8" defer></script>

<!-- include all js in scripts folder -->


  <script src="/_scripts/anchors.js"></script>

  <script src="/_scripts/dark-mode.js"></script>

  <script src="/_scripts/fetch-tags.js"></script>

  <script src="/_scripts/search.js"></script>

  <script src="/_scripts/site-search.js"></script>

  <script src="/_scripts/tooltip.js"></script>


</head>

  <body>
    







<header class="background" style="--image: url('/images/background_arctic.JPG')" data-dark="true">
  <a href="/" class="home">
    
      <span class="logo">
        
          <img src="/images/logo.png" alt="logo">
        
      </span>
    
    
      <span class="title" data-tooltip="Home">
        
          <span>nicholson boom-lab</span>
        
        
          <span>Woods Hole Oceanographic Institution</span>
        
      </span>
    
  </a>

  <input class="nav-toggle" type="checkbox" aria-label="show/hide nav">

  <nav>
    
    
      
        <a href="/team/" data-tooltip="About our team">
          Team
        </a>
      
    
      
        <a href="/projects/" data-tooltip="Software, datasets, and more">
          Projects
        </a>
      
    
      
        <a href="/research/" data-tooltip="Published works">
          Publications
        </a>
      
    
      
        <a href="/blog/" data-tooltip="Musings and miscellany">
          Blog
        </a>
      
    
      
        <a href="/contact/" data-tooltip="Email, address, and location">
          Join Us!
        </a>
      
    
  </nav>
</header>

    <main>
      <!--
  modify main content of page:
  - add section breaks
  - attach section properties
  - wrap each table in div to allow for scrolling
  - filter out blank sections
-->








  
  
  

  <section class="background" data-size="page">
    <h1 class="center">Poseidon basics</h1>

<div class="post-info">
  
    
    
      

<div class="portrait-wrapper">
  <a href="/members/colette-kelly.html" class="portrait" data-style="tiny" aria-label="Colette Kelly">
    <img src="https://nitrogen.stanford.edu/sites/g/files/sbiybj20311/files/styles/medium_square/public/media/person/colettelkelly1604361295658.jpg?h=98492e8c&itok=QAGlgsTR" class="portrait-image" alt="member portrait" loading="lazy" onerror="this.src = '/images/fallback.svg'; this.onerror = null;">

    
      <span class="portrait-text">
        
          <span class="portrait-name">
            Colette Kelly
          </span>
        
        
        
          <span class="portrait-role">
            
            <i class="icon fa-solid fa-glasses"></i>
            <span>Postdoctoral Researcher</span>
          </span>
        
        
          <span class="portrait-pronouns">
            They/Them
          </span>
        
      </span>
    
  </a>
</div>

    
  

  
  

  
    <span data-tooltip="Originally published on">
      <i class="icon fa-regular fa-calendar"></i>
      <span>October 03, 2023</span>
    </span>
  

  
    <span data-tooltip="Last updated on">
      <i class="icon fa-solid fa-clock-rotate-left"></i>
      <span>January 02, 2024</span>
    </span>
  
</div>


  


  <div class="tags" data-link="/blog">
    
      <a href="/blog?search=%22tag:%20lab%22" class="tag" data-tooltip='Show items with the tag "lab"'>
        lab
      </a>
    
      <a href="/blog?search=%22tag:%20how-to%22" class="tag" data-tooltip='Show items with the tag "how-to"'>
        how-to
      </a>
    
      <a href="/blog?search=%22tag:%20computing%22" class="tag" data-tooltip='Show items with the tag "computing"'>
        computing
      </a>
    
  </div>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<h1 id="using-python-on-poseidon">Using Python on Poseidon</h1>
<p>Quick overview of connecting to and running Python scripts on Poseidon.</p>

<p>Logging in:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>colette<span class="nv">$ </span>ssh &lt;WHOI ID&gt;@poseidon.whoi.edu
</code></pre></div></div>

<h2 id="slurm-basics">Slurm basics</h2>
<p>Slurm is the resource manager on Poseidon. It lets you request computing resources and submit jobs to the cluster. You submit jobs with Sbatch scripts, which tell Slurm what computing resources you need, and then run the commands to activate virtual environments and run Python scripts (example <a href="https://github.com/boom-lab/poseidon-data/blob/main/cds/get_era5.sh">here</a>). Slurm also lets you start an interactive session from which you can run Jupyter Notebooks (more info <a href="https://boom.science/2023/10/02/poseidon-jupyter.html">here</a>).</p>

<p>Start a <code class="language-plaintext highlighter-rouge">bash</code> interactive session on a compute node with one core for 20 minutes:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>srun <span class="nt">-N</span> 1 <span class="nt">-n</span> 1 <span class="nt">--mem</span><span class="o">=</span>500 <span class="nt">--time</span><span class="o">=</span>00:20:00 <span class="nt">--pty</span> bash
</code></pre></div></div>
<p><em>[colette.kelly@poseidon-l1 ~] indicates that we are on login node 1 of Poseidon’s two login nodes.</em><br></p>

<p>Submit a job:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>sbatch &lt;scriptname&gt;.sh
</code></pre></div></div>
<p>See what jobs are currently running:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>squeue <span class="nt">-u</span> &lt;WHOI ID&gt;
</code></pre></div></div>
<p>Cancel a job:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>scancel &lt;JOBID&gt;
</code></pre></div></div>
<p>Track how much memory a job is using:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l2 era5]<span class="nv">$ </span>sstat <span class="nt">-j</span> 3190091 <span class="nt">--format</span><span class="o">=</span>JobID,MaxRSS
       JobID     MaxRSS 
<span class="nt">------------</span> <span class="nt">----------</span> 
3190091.0       254340K
</code></pre></div></div>
<p>Get effective job usage for completed job (this example is terrible, your efficiency should be way better than this!!):</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l2 cds]<span class="nv">$ </span>seff 3190107
Job ID: 3190107
Cluster: slurm_cluster
User/Group: colette.kelly/domain <span class="nb">users
</span>State: COMPLETED <span class="o">(</span><span class="nb">exit </span>code 0<span class="o">)</span>
Nodes: 1
Cores per node: 20
CPU Utilized: 00:05:22
CPU Efficiency: 1.21% of 07:25:00 core-walltime
Job Wall-clock <span class="nb">time</span>: 00:22:15
Memory Utilized: 903.89 MB
Memory Efficiency: 44.14% of 2.00 GB
</code></pre></div></div>

<h2 id="syncing-files-to-poseidon">Syncing files to Poseidon</h2>
<p>There are lots of ways to sync files between Poseidon and your local machine. My preferred way is to clone Github repositories directly into my home directory on Poseidon. This gives you all the benefits of git (version control, branches) so you can undo changes if you mess things up.</p>

<p>A really simple way to sync files is with secure copy. Instructions are below because the Poseidon documentation is a bit out of date as of writing (10/3/23).</p>

<ol>
  <li>Secure copy a file from local machine to Poseidon <br>
Open a Terminal on your local machine and run:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>colette<span class="nv">$ </span>scp &lt;local-filename&gt; &lt;whoiID&gt;@poseidon.whoi.edu:/vortexfs1/home/&lt;whoiID&gt;/&lt;remote-filename&gt;
</code></pre></div>    </div>
  </li>
  <li>Secure copy a file from Poseidon to local machine <br>
Open a Terminal on your local machine and run:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>colette<span class="nv">$ </span>scp &lt;whoiID&gt;@poseidon.whoi.edu:/vortexfs1/home/&lt;whoiID&gt;/&lt;remote-filename&gt; &lt;local-filename&gt;
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="running-python-code-with-3rd-party-packages-on-poseidon">Running Python code with 3rd-party packages on Poseidon</h2>
<p>There are a few steps you need to take before you can run Python code that relies on 3rd-party packages (Pandas, Numpy, etc.) on Poseidon. The best way to install and manage these 3rd-party packages is to create a virtual environment for each project you’re working on (more info on virtual environments <a href="https://github.com/stanfordpython/python-handouts/blob/master/virtual-environments.md">here</a>). Below are instructions for creating a virtual environment and installing packages with conda and with Pip, the built-in Python package manager.</p>

<h3 id="creating-a-virtual-environment-with-conda">Creating a virtual environment with conda</h3>
<ol>
  <li>Module load Anaconda
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l2 ~]<span class="nv">$ </span>module load anaconda3/2021.11
</code></pre></div>    </div>
  </li>
  <li>Create the virtual environment based on an environment.yml file
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l2]<span class="nv">$ </span>conda <span class="nb">env </span>create <span class="nt">-f</span> environment.yml
</code></pre></div>    </div>
    <p>(You can also activate the virtual environment and install packages individually)</p>
  </li>
  <li>Activate the virtual environment
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l2]<span class="nv">$ </span><span class="nb">source </span>activate &lt;env-name&gt;
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="creating-a-python-virtual-environment-with-pip">Creating a Python virtual environment with Pip</h3>
<ol>
  <li>Module load Python3.9
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>module load python3/3.9.10
</code></pre></div>    </div>
    <p><em>Note that while Poseidon has a Python3.10 module, as of writing (8/15/2023), the python3/3.10.2 module does not have the SSL certificate installed for the Python Package Index. This essentially means that trying to install packages with pip in the python3/3.10.2 module will throw an error. So for the time being, use the python3/3.9.10, instead. You CAN use conda to set up a virtual environment in the python3/3.10.2 module and install packages in that conda environment, but updating conda on Poseidon takes an extremely long time (&gt; 3hours) right now so this is not recommended.</em></p>
  </li>
  <li>Create a virtual environment called “py39-env” with Python3.9:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>python3 <span class="nt">-m</span> venv ~/py39-env
</code></pre></div>    </div>
  </li>
  <li>Activate the virtual environment:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span><span class="nb">source</span> ~/py39-env/bin/activate
</code></pre></div>    </div>
  </li>
  <li>Install all of the packages in a requirements.txt file (<a href="https://github.com/boom-lab/poseidon-data/blob/main/requirements.txt">example</a>) in the virtual environment:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">(</span>py39-env<span class="o">)</span> <span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">-r</span> poseidon-data/requirements.txt
</code></pre></div>    </div>
  </li>
  <li>OR, install one package at a time (for example, Pandas):
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">(</span>py39-env<span class="o">)</span> <span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>python3 <span class="nt">-m</span> pip <span class="nb">install </span>Pandas
</code></pre></div>    </div>
  </li>
  <li>Leave the virtual environment:
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="o">(</span>py39-env<span class="o">)</span> <span class="o">[</span>colette.kelly@poseidon-l1 ~]<span class="nv">$ </span>deactivate
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="run-a-python-script-on-poseidon">Run a Python script on Poseidon</h3>
<p>Once a virtual environment is activated (either in an interactive session or in a Batch script), you’ll have access to the version of Python in that environment, as well as all of the Python packages you’ve installed in that virtual environment. Now, you can run a script that requires 3rd-party packages:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>colette.kelly@pn055 ~]<span class="nv">$ </span>python3 get_era5.py
</code></pre></div></div>

<p>If you’re running the python code with a batch script, include a line to activate the virtual environment before the command to run the Python script, as in this <a href="https://github.com/boom-lab/poseidon-data/blob/main/examples/python3rdparty.sh">example</a>.</p>
  </section>

  
  
  

  <section class="background" data-size="page">
    <!--
  background: ;
  dark: ;
  size: ;
-->


<div class="post-nav">
  <span>
    
      <i class="icon fa-solid fa-angle-left"></i> Previous post<br>
      <a href="/2023/10/02/poseidon-jupyter.html">
        Running Jupyter Notebooks on Poseidon
      </a>
    
  </span>
  <span>
    
  </span>
</div>
  </section>


    </main>
    


<footer class="background" style="--image: url('/images/background_arctic2.JPG')" data-dark="true" data-size="wide">
  <!--
    <div>
      Extra details like contact info or address
    </div>
  -->

  <div>
    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="mailto:dnicholson@whoi.edu" data-tooltip="Email" data-style="bare" aria-label="Email">
      <i class="icon fa-solid fa-envelope"></i>
      
    </a>
  </div>


    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://orcid.org/0000-0003-2653-9349" data-tooltip="ORCID" data-style="bare" aria-label="ORCID">
      <i class="icon fa-brands fa-orcid"></i>
      
    </a>
  </div>


    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://scholar.google.com/citations?user=i0QbkNgAAAAJ" data-tooltip="Google Scholar" data-style="bare" aria-label="Google Scholar">
      <i class="icon fa-brands fa-google"></i>
      
    </a>
  </div>


    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://github.com/boom-lab" data-tooltip="GitHub" data-style="bare" aria-label="GitHub">
      <i class="icon fa-brands fa-github"></i>
      
    </a>
  </div>


    
      
      
      



  <div class="button-wrapper">
    <a class="button" href="https://twitter.com/whoiboomlab" data-tooltip="Twitter" data-style="bare" aria-label="Twitter">
      <i class="icon fa-brands fa-twitter"></i>
      
    </a>
  </div>


    
  </div>

  <div>
    © 2024
    nicholson boom-lab
      |   Built with
    <a href="https://github.com/greenelab/lab-website-template">
      Lab Website Template
    </a>
  </div>

  <input type="checkbox" class="dark-toggle" data-tooltip="Dark mode" aria-label="toggle dark mode" oninput="onDarkToggleChange(event)">
</footer>

  </body>
</html>
